scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
pat2 <- data.frame(id=c(4,4,4),treatment=c('Brigatinib','Crizotinib','Ceritinib',),
dose=c(750,120,50),start=c(1,4,6),end=c(2.5,7,8))
pat2 <- data.frame(id=c(4,4,4),treatment=c('Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,120,50),start=c(1,4,6),end=c(2.5,7,8))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1,2,3,3,3,4,4,4),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib','Brigatinib',
'Ceritinib','Ceritinib','Ceritinib','Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,700,650,600,500,90,120,180,750,150,100,50,750,120,50), start=c(2,3,4,6,7,10,13,15,0,0,3,5,1,4,6),end=c(3,4,6,7,8,13,15,17,15,3,5,9,2.5,7,8))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3),grade=c("1","2","3","3","4","5",'2','2'),time=c(3,4,6,7,8,15,3,5),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','4','4','4'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','3','3','5'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
swim_plot_pattern(df=df,col="black",name_fill='pre_study_treatment',name_pattern = 'pre_study_treatment',name_pattern_fill = 'pre_study_treatment',pattern_density=0.5)+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey90','Surgery'='grey90','Nothing'='white')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
scale_pattern_manual(name="Pre study Treatment",values = c('Radiation'='none','Surgery'='none','Nothing'='none','Radiation+Surgery'='stripe')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing')) +
scale_pattern_fill_manual(name="Pre study Treatment",values = c('Radiation'='white','Surgery'='white','Nothing'='white','Radiation+Surgery'='grey30')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA)),pattern_fill=guide_legend(order = 1,ncol=4),pattern=guide_legend(order = 1,ncol=4))+
#guides(fill = guide_legend(order = 1,ncol=4,))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1,2,3,3,3,4,4,4),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib','Brigatinib',
'Ceritinib','Ceritinib','Ceritinib','Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,700,650,600,500,90,120,180,750,150,100,50,750,120,50), start=c(2,3,4,6,7,10,13,15,0,0,3,5,1,4,6),end=c(3,4,6,7,8,13,15,17,15,3,5,9,2.5,5,8))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','3','3','5'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1),
treatment=c('Brigatinib','Crizotinib','Crizotinib','Crizotinib','Brigatinib'),
dose=c(750,90,180,120,600), start=c(2,4,6,7,8),end=c(3,6,7,7.5,9))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib'),
dose=c(750,700,650,600,500,90,120,180), start=c(2,3,4,6,7,10,13,15),end=c(3,4,6,7,8,13,15,17))
ae <- data.frame(id=c(1,1,1,1,1),grade=c("1","2","3","3","4"),time=c(3,4,6,7,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swim_plot_pattern(df=df,col="black",name_fill='pre_study_treatment',name_pattern = 'pre_study_treatment',name_pattern_fill = 'pre_study_treatment',pattern_density=0.5)+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey90','Surgery'='grey90','Nothing'='white')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
scale_pattern_manual(name="Pre study Treatment",values = c('Radiation'='none','Surgery'='none','Nothing'='none','Radiation+Surgery'='stripe')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing')) +
scale_pattern_fill_manual(name="Pre study Treatment",values = c('Radiation'='white','Surgery'='white','Nothing'='white','Radiation+Surgery'='grey30')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA)),pattern_fill=guide_legend(order = 1,ncol=4),pattern=guide_legend(order = 1,ncol=4))+
#guides(fill = guide_legend(order = 1,ncol=4,))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
library(ggplot2)
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1,2,3,3,3,4,4,4),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib','Brigatinib',
'Ceritinib','Ceritinib','Ceritinib','Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,700,650,600,500,90,120,180,750,150,100,50,750,120,50), start=c(2,3,4,6,7,10,13,15,0,0,3,5,1,4,6),end=c(3,4,6,7,8,13,15,17,15,3,5,9,2.5,5,8))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','3','3','5'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1),
treatment=c('Brigatinib','Crizotinib','Crizotinib','Crizotinib','Brigatinib'),
dose=c(750,90,180,120,600), start=c(2,4,6,7,8),end=c(3,6,7,7.5,9))
swim_plot_pattern(df=df,col="black",name_fill='pre_study_treatment',name_pattern = 'pre_study_treatment',name_pattern_fill = 'pre_study_treatment',pattern_density=0.5)+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey90','Surgery'='grey90','Nothing'='white')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
scale_pattern_manual(name="Pre study Treatment",values = c('Radiation'='none','Surgery'='none','Nothing'='none','Radiation+Surgery'='stripe')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing')) +
scale_pattern_fill_manual(name="Pre study Treatment",values = c('Radiation'='white','Surgery'='white','Nothing'='white','Radiation+Surgery'='grey30')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA)),pattern_fill=guide_legend(order = 1,ncol=4),pattern=guide_legend(order = 1,ncol=4))+
#guides(fill = guide_legend(order = 1,ncol=4,))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1,2,3,3,3,4,4,4),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib','Brigatinib',
'Ceritinib','Ceritinib','Ceritinib','Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,700,650,600,500,90,120,180,750,150,100,50,750,120,50), start=c(2,3,4,6,7,10,13,15,0,0,3,5,1,4,6),end=c(3,4,6,7,8,13,15,17,15,3,5,9,2.5,5,8))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','3','3','5'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
swim_plot_pattern(df=df,col="black",name_fill='pre_study_treatment',name_pattern = 'pre_study_treatment',name_pattern_fill = 'pre_study_treatment',pattern_density=0.5)+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey90','Surgery'='grey90','Nothing'='white')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
scale_pattern_manual(name="Pre study Treatment",values = c('Radiation'='none','Surgery'='none','Nothing'='none','Radiation+Surgery'='stripe')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing')) +
scale_pattern_fill_manual(name="Pre study Treatment",values = c('Radiation'='white','Surgery'='white','Nothing'='white','Radiation+Surgery'='grey30')
,breaks=c('Radiation','Surgery','Radiation+Surgery','Nothing'))+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA)),pattern_fill=guide_legend(order = 1,ncol=4),pattern=guide_legend(order = 1,ncol=4))+
#guides(fill = guide_legend(order = 1,ncol=4,))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
full_treatment <- data.frame(id=c(1,1,1,1,1,1,1,1,2,3,3,3,4,4,4),
treatment=c('Brigatinib','Brigatinib','Brigatinib','Brigatinib','Brigatinib',
'Crizotinib','Crizotinib','Crizotinib','Brigatinib',
'Ceritinib','Ceritinib','Ceritinib','Brigatinib','Crizotinib','Ceritinib'),
dose=c(750,700,650,600,500,90,120,180,750,150,100,50,750,120,50), start=c(2,3,4,6,7,10,13,15,0,0,3,5,1,4,6),end=c(3,4,6,7,8,13,15,17,15,3,5,9,2.5,5,8))
ae <- data.frame(id=c(1,1,1,1,1,2,3,3,4,4,4),grade=c("1","2","3","3","4","5",'2','2','3','3','5'),time=c(3,4,6,7,8,15,3,5,2.5,5,8),
type=c("Fever",'Nausea',"Fever","Fever","Fever","Infection",'Nausea',"Fever","Infection","Infection","Infection"))
df <- data.frame(id=c(1,2,3,4,5,6),end=c(17,15,12,8,6,4),pre_study_treatment=factor(c('Surgery',
'Radiation+Surgery',
'Surgery',
'Radiation+Surgery',
'Radiation',
'Nothing')))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")+
swimmer_points(df=ae,name_shape = "grade",size=4,col="white",stroke=2)+
scale_shape_manual(name="AE grade",values=c("1"="1","2"='2',"3"='3',"4"='4','5'='5'),
guide=guide_legend(ncol=4,order=3,override.aes = list(col=1)),
labels=c("1"="Mild","2"='Moderate',"3"='Severe',"4"='Life-threatening','5'='death'))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))+
new_scale("shape")
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment,name_col = 'dose',size=15)
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment,name_col = 'dose',size=15)+
swimmer_points(df=ae,name_shape = "type",size=8)
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))
```{r, echo = TRUE,fig.align='centre',fig.width=11}
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))
swimmer_plot(df=df,col="black",name_fill='pre_study_treatment')+ scale_fill_manual(name="Pre study Treatment",values = c('Radiation'='grey30','Radiation+Surgery'='grey60','Surgery'='grey90','Nothing'='white'),
breaks=c('Radiation',
'Surgery',
'Radiation+Surgery',
'Nothing'))+
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Crizotinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Crizotinib(mg)",low = "#FEF0D9", high = "#E34A33")+
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Brigatinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Brigatinib(mg)",
low = "#9ECAE1", high = "#084594") +
new_scale("colour") +
swimmer_lines(df_lines = full_treatment[full_treatment$treatment=="Ceritinib",],name_col = 'dose',size=15)+
scale_colour_gradient("Ceritinib(mg)",
low = "#C7E9C0", high = "#005A32") +
guides(fill = guide_legend(order = 1,ncol=4,override.aes = list(shape = NA,col=NA))) +
swimmer_points(df=ae,name_shape = "type",size=8)+
scale_shape_manual(name="AE",values=c("Fever"=19,'Nausea'=15,'Infection'=17),guide=guide_legend(ncol=3,order=2))
